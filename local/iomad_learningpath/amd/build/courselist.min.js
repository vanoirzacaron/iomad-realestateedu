/**
 * @module    local_learningpath
 * @copyright 2021 Derick Turner
 * @author    Derick Turner
 * @license   http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
 */
define("local_iomad_learningpath/courselist",["jquery","jqueryui","core/config","core/ajax","core/notification","core/templates"],(function($,jqui,mdlcfg,ajax,notification,templates){return{init:function(companyid,pathid){function course_list(){var filter=$("#coursefilter").val(),category=$("#category").val(),program=$("#program").val();ajax.call([{methodname:"local_iomad_learningpath_getprospectivecourses",args:{pathid:pathid,filter:filter,category:category,program:program},done:function(courses){!function(courses){if($("#prospectivelist li").remove(),courses.length){$("#noprospective").hide();var context={courses:courses,wwwroot:mdlcfg.wwwroot,prospective:!0};templates.render("local_iomad_learningpath/prospectivelist",context).done((function(html){$("#prospectivelist").append(html)})).fail(notification.exception)}else $("#noprospective").show()}(courses)},fail:notification.exception}])}function pathcourse_list(){$(".pathcourselist").each((function(){var pcl=this,groupid=$(pcl).data("groupid");ajax.call([{methodname:"local_iomad_learningpath_getcourses",args:{pathid:pathid,groupid:groupid},done:function(courses){!function(pcl,courses){$(pcl).find("li").remove();var groupid=$(pcl).data("groupid"),nogroupcourses=$(".nogroupcourses[data-groupid='"+groupid+"']");if(courses.length){nogroupcourses.hide();var context={courses:courses,wwwroot:mdlcfg.wwwroot,prospective:!1};templates.render("local_iomad_learningpath/pathcourselist",context).done((function(html){$(pcl).append(html)})).fail(notification.exception)}else nogroupcourses.show()}(pcl,courses)},fail:notification.exception}])}))}function fix_icons(){$("#prospectivelist .path-delete").removeClass("fa-trash path-delete").addClass("fa-plus path-add"),$(".pathcourselist .path-add").removeClass("fa-plus path-add").addClass("fa-trash path-delete")}$(window).on("load",course_list()),$("#program").on("change",(function(){course_list(),pathcourse_list()})),$("#coursefilter").on("input",(function(){course_list()})),$("#category").on("change",(function(){course_list()})),$("#prospectivelist, .pathcourselist").on("mouseenter","li",(function(){$(this).addClass("text-primary")})),$("#prospectivelist, .pathcourselist").on("mouseleave","li",(function(){$(this).removeClass("text-primary")})),$(window).on("load",pathcourse_list()),$("#prospectivelist").on("click",".path-add",(function(){var courseid=$(this).data("courseid");ajax.call([{methodname:"local_iomad_learningpath_addcourses",args:{pathid:pathid,courseids:[courseid]},done:function(){pathcourse_list(),course_list()},fail:notification.exception}])})),$(".pathcourselist").on("click",".path-delete",(function(){var courseid=$(this).data("courseid");ajax.call([{methodname:"local_iomad_learningpath_removecourses",args:{pathid:pathid,courseids:[courseid]},done:function(){pathcourse_list(),course_list()},fail:notification.exception}])})),$(".pathcourselist").sortable({handle:".lphandle",connectWith:"#prospectivelist, .pathcourselist",dropOnEmpty:!0,update:function(){var courses=[];$(".pathcourselist .pathbox").each((function(){var courseid=$(this).data("courseid"),groupid=$(this).parent().parent().data("groupid");courses.push({courseid:courseid,groupid:groupid})})),ajax.call([{methodname:"local_iomad_learningpath_ordercourses",args:{pathid:pathid,courses:courses},done:function(){},fail:notification.exception}]),fix_icons()}}),$("#prospectivelist").sortable({handle:".lphandle",connectWith:".pathcourselist",dropOnEmpty:!0,update:function(){fix_icons()}})}}}));

//# sourceMappingURL=courselist.min.js.map